<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dc.mapper.DcResourceMapper">
	
	<!-- 자원 정보관리 목록 조회 -->
	<select id="selectDcResourceList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		/* mapper.dc.dcResourceMapper : selectDcResourceList */
		SELECT 
			HUMANID
			,CENTER 
			,WHOUSE 
			,DEPT 
			,CASE WHEN CODE_YN = 'Y' THEN '출력' ELSE '미출력' END as CODE_YN
			,CASE WHEN USE_YN = 'Y' THEN '사용' ELSE '미사용' END as USE_YN
			,CCODE_INFO
		FROM GJ_DC.HUMAN_INFO
		WHERE 1=1
		<if test='schCenter != null and schCenter != ""'>
			AND CENTER LIKE CONCAT('%',#{schCenter},'%')
		</if> 
		<if test='schWhouse != null and schWhouse != ""'>
			AND WHOUSE LIKE CONCAT('%',#{schWhouse},'%')
		</if> 
		<if test='schUseYn != null and schUseYn != ""'>
			AND USE_YN = #{schUseYn}
		</if> 
		ORDER BY CRE_DT ASC
	</select>
	
	<!-- 자원 정보관리 등록 및 수정 -->
	<insert id="insertDcResourceInfo" parameterType="java.util.List">
		/* mapper.dc.dcResourceMapper : insertDcResourceInfo */
		INSERT INTO GJ_DC.HUMAN_INFO(
			HUMANID 
			,CENTER 
			,WHOUSE 
			,DEPT 
			,CODE_YN 
			,USE_YN 
			,CCODE_INFO
			,CRE_DT 
			,CRE_USER_ID 
			,MOD_DT 
			,MOD_USER_ID
		) VALUES
		<foreach collection="list" item="item" separator=",">
			(
				<choose>
					<when test='item.HUMANID != null and !item.HUMANID.equals("")'>
						#{item.HUMANID}
					</when>
					<otherwise>
						CONCAT(#{date}, LPAD(CAST(nextVAL(GJ_DC.dc_human_info_seq) AS CHAR(4)), 4 ,'0'))
					</otherwise>
				</choose>
				,#{item.CENTER} 
				,#{item.WHOUSE} 
				,#{item.DEPT} 
				,IF(#{item.CODE_YN} = '미출력', 'N', 'Y') 
				,IF(#{item.USE_YN} = '미사용' , 'N', 'Y') 
				,#{item.CCODE_INFO} 
				,NOW() 
				,#{login_id} 
				,NOW() 
				,#{login_id}
			)
		</foreach>
		 ON DUPLICATE KEY UPDATE
							CENTER = VALUES(CENTER)
							,WHOUSE = VALUES(WHOUSE)
							,DEPT = VALUES(DEPT)
							,CODE_YN = VALUES(CODE_YN)
							,USE_YN = VALUES(USE_YN)
							,CCODE_INFO = VALUES(CCODE_INFO)
		
	</insert>
	
	<!-- 자원 정보관리 삭제 -->
	<delete id="deleteDcResourceInfo" parameterType="java.util.List">
		DELETE FROM GJ_DC.HUMAN_INFO
		WHERE
			HUMANID IN ( 
				<foreach collection="list" item="item" separator=",">
					#{item.HUMANID}
				</foreach>
			)
	</delete> 
</mapper>